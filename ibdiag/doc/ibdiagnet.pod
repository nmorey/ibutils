=head1 NAME

B<ibdiagnet - IB diagnostic net>

=head1 SYNOPSYS

ibdiagnet [-c <count>] [-v] [-r] [-t <topo-file>] [-s <sys-name>]
  [-i <dev-index>] [-p <port-num>] [-o <out-dir>]
  [-lw <1x|4x|12x>] [-ls <2.5|5|10>] [-pm]

=head1 DESCRIPTION

ibdiagnet scans the fabric using directed route packets and extracts all the available information regarding its connectivity and devices.
It then produces the following files in the output directory (which defined by the -o option (see below)).

=head1 FILES

=over

=item F<ibdiagnet.log> - 

A dump of all the application reports generate according to the provided flags

=item F<ibdiagnet.lst> - 

List of all the nodes, ports and links in the fabric

=item F<ibdiagnet.fdbs> - 

A dump of the unicast forwarding tables of the fabric switches

=item F<ibdiagnet.mcfdbs> - 

A dump of the multicast forwarding tables of the fabric switches

=item F<ibdiagnet.masks> -

In case of duplicate port/node Guids, these file include the map between masked Guid and real Guids 

=item F<ibdiagnet.sm> - 

List of all the SM (state and priorty) in the fabric
  
=item F<ibdiagnet.pm> -

A dump of the pm Counters values, of the fabric links

=back

In addition to generating the files above, the discovery phase also checks for duplicate node/port GUIDs in the IB fabric. If such an error is detected, it is displayed on the standard output. After the discovery phase is completed, directed route packets are sent multiple times (according to the -c option) to detect possible problematic paths on which packets may be lost. Such paths are explored, and a report of the suspected bad links is displayed on the standard output.

After scanning the fabric, if the -r option is provided, a full report of the fabric qualities is displayed.
This report includes: 

=over 

=item * 
B<SM report>

=item * 
B<Number of nodes and systems>

=item * 
B<Hop-count information>

=over 

=item
maximal hop-count, an example path, and a hop-count histogram

=back

=item * 
B<All CA-to-CA paths traced>

=item *
B<Credit loop report>

=item *
B<mgid-mlid-HCAs matching table>

=back

Note: In case the IB fabric includes only one CA, then CA-to-CA paths are not reported.
Furthermore, if a topology file is provided, ibdiagnet uses the names defined in it for the output reports.
      
=head1 OPTIONS

=over

=item B<-c <count>>      : 

=over

=item
Min number of packets to be sent across each link (default = 10)
	
=back

=item B<-v>              : 

=over

=item
Enable verbose mode

=back

=item B<-r>              :

=over

=item
Provides a report of the fabric qualities

=back

=item B<-t <topo-file>>  : 

=over

=item
Specifies the topology file name

=back

=item B<-s <sys-name>>   :

=over

=item
Specifies the local system name. Meaningful only if a topology file is specified

=back

=item B<-i <dev-index>>  : 

=over

=item
Specifies the index of the device of the port used to connect to the IB fabric (in case of multiple devices on the local system)

=back

=item B<-p <port-num>>   : 

=over

=item
Specifies the local device's port num used to connect to the IB fabric

=back

=item B<-o <out-dir>>    :

=over

=item
Specifies the directory where the output files will be placed (default = /tmp)

=back

=item B<-lw <1x|4x|12x>> :

=over

=item
Specifies the expected link width

=back

=item B<-ls <2.5|5|10>>  :

=over

=item
Specifies the expected link speed

=back

=item B<-pm>             :

=over

=item
Dump all the fabric links, pm Counters into ibdiagnet.pm

=back

=item B<-h|--help>       : 

=over

=item
Prints the help page information

=back

=item B<-V|--version>    :

=over

=item
Prints the version of the tool

=back

=item B<--vars>          :

=over

=item
Prints the tool's environment variables and their values

=back

=back

=head1 ERROR CODES

=over

=item 1 -
Failed to fully discover the fabric

=item 2 - 
Failed to parse command line options

=item 3 - 
Failed to intract with IB fabric

=item 4 - 
Failed to use local device or local port

=item 5 - 
Failed to use Topology File

=item 6 - 
Failed to load requierd Package

=back
